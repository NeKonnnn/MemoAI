# MemoAI

MemoAI - это персональный ассистент с поддержкой текстового и голосового общения, основанный на работе с языковыми моделями в формате GGUF.

## Возможности

- Текстовый чат с языковой моделью
- Голосовое общение (синтез и распознавание речи)
- Работа с документами (.pdf, .docx, .xlsx) 
- Транскрибация аудио и видео (включая YouTube)
- Онлайн-транскрибация совещаний и конференций
- Сохранение истории общения
- Современный графический интерфейс на PyQt6
- Управление моделями (добавление, удаление, выбор)
- Настройка параметров модели LLM (размер контекста, точность генерации и т.д.)
- Выбор голоса для синтеза речи
- Светлая и темная темы интерфейса

## Требования

- Python 3.8 или выше
- PyQt6
- llama-cpp-python
- vosk (для распознавания речи)
- torch и torchaudio (для синтеза речи)
- python-docx, PyPDF2, openpyxl (для работы с документами)
- whisper, moviepy, pytube (для транскрибации)

## Установка

1. Клонируйте репозиторий:
```
git clone https://github.com/username/memoai.git
cd memoai
```

2. Установите зависимости:
```
pip install -r requirements.txt
```

3. Загрузите языковую модель с Hugging Face (https://huggingface.co/models?sort=downloads&search=gguf) в формате GGUF и поместите её в директорию `models/`.

4. Загрузите модель для распознавания речи Vosk (https://alphacephei.com/vosk/models) и распакуйте в директорию `model_small/`.

5. Загрузите Silero TTS для синтеза речи (GitHub: https://github.com/snakers4/silero-models) и распакуйте в директорию `silero_models/`.

6. Загрузите и установите на свой ПК: VB-Cable (https://vb-audio.com/Cable/) и Virtual Audio Cable (https://www.vb-audio.com/Voicemeeter/index.htm) для онлайн транскрибации звука с совещаний.

## Запуск

### Графический интерфейс (рекомендуется):
```
python main.py
```

### Запуск с указанием режима (текстовый или голосовой):
```
python main.py text  # для текстового режима в консоли
python main.py voice  # для голосового режима в консоли
python main.py gui    # для графического интерфейса
```

## Настройка

Настройки программы хранятся в файлах:
- `settings.json` - основные настройки (модели, голос синтеза речи, тема интерфейса)  
- `llm_settings.json` - параметры языковой модели (размер контекста, температура и др.)

Оба файла будут созданы автоматически при первом запуске со значениями по умолчанию.

## Функции графического интерфейса

- **Текстовый чат**: Общение с ассистентом через текстовый ввод
- **Голосовой чат**: Общение с ассистентом через микрофон и динамики
- **Работа с документами**: Загрузка и анализ документов, запросы к содержимому
- **Транскрибация**: Преобразование аудио/видео в текст, включая Youtube и Zoom
- **Онлайн-совещания**: Транскрибация совещаний и конференций в реальном времени
- **Управление моделями**: Добавление, удаление и выбор языковых моделей
- **Настройки LLM**: Настройка параметров работы языковой модели
- **Настройки голосового режима**: Выбор голоса для синтеза речи
- **Настройки интерфейса**: Переключение между светлой и темной темой

## Работа с документами

Модуль работы с документами поддерживает следующие типы файлов:
- PDF документы (*.pdf)
- Документы Microsoft Word (*.docx)
- Таблицы Microsoft Excel (*.xlsx, *.xls)

После загрузки документа вы можете задавать вопросы по его содержимому, например:
- "Сделай краткий пересказ документа"
- "Найди в документе информацию о..."
- "Ответь на вопрос, есть ли в документе упоминание о..."

Система использует векторное хранилище для поиска релевантной информации в документах и отвечает на основе найденного контекста.

## Транскрибация

Модуль транскрибации поддерживает:
- Аудиофайлы (*.mp3, *.wav, *.m4a, *.aac, *.flac)
- Видеофайлы (*.mp4, *.avi, *.mov, *.mkv, *.webm)
- Видео с YouTube (по URL)
- Записи встреч Zoom

Результаты транскрибации можно:
- Скопировать в буфер обмена
- Сохранить в текстовый файл
- Использовать для дальнейшего анализа

## Онлайн-транскрибация совещаний

Модуль онлайн-транскрибации позволяет:
- Транскрибировать совещания и конференции в реальном времени
- Одновременно записывать звук с микрофона (ваш голос) и системного аудио (голоса собеседников)
- Сохранять стенограмму совещания с указанием времени и говорящего
- Копировать и сохранять результаты в буфер обмена или файл

Для захвата системного аудио в Windows используйте:
1. "Стерео микшер" (Stereo Mix) - встроенное решение в Windows
2. Виртуальный аудиокабель (VB-Cable, Virtual Audio Cable) - устанавливается отдельно

## Запись совещаний и собраний

MemoAI поддерживает запись и транскрибацию совещаний, включая захват системного звука (голоса собеседников). Это позволяет записывать и расшифровывать как ваш голос, так и голоса участников на другом конце провода.

### Как пользоваться функцией записи совещаний:

1. В главном окне приложения перейдите на вкладку "Совещания".
2. Установите флажки:
   - "Записывать микрофон" для записи вашего голоса
   - "Записывать аудио системы" для записи голосов собеседников
3. Нажмите кнопку "Обновить список" и выберите устройство для захвата аудио системы:
   - Если у вас включен "Стерео микшер" (Stereo Mix), выберите его
   - На некоторых компьютерах может быть другое устройство для захвата системного звука
4. Нажмите "Начать запись" и говорите в микрофон.
5. По завершении нажмите "Остановить запись".
6. Транскрипция сохранится в текстовой области.

### Настройка захвата системного звука (Stereo Mix)

Чтобы включить "Стерео микшер" в Windows:
1. Правый клик на значок звука в трее → "Звуки"
2. Перейдите на вкладку "Запись"
3. Правый клик в пустом месте → "Показать отключенные устройства"
4. Найдите "Стерео микшер", правый клик → "Включить"
5. Если устройство не появилось, возможно, ваша звуковая карта не поддерживает эту функцию

Альтернативное решение:
- Установите виртуальный аудиокабель [VB-Cable](https://vb-audio.com/Cable/) и выберите его в списке устройств для захвата системного звука.

## Запись голоса собеседника из удаленных встреч

MemoAI теперь поддерживает запись и транскрибацию голоса собеседника из удаленных встреч и звонков без использования внешних программ типа VB-Cable или Stereo Mix.

### Как использовать:

1. Запустите скрипт `capture_remote_audio.py` с нужными параметрами:
   ```
   python capture_remote_audio.py --device 23 --duration 60
   ```

2. Параметры:
   - `--list` - показать список доступных аудиоустройств
   - `--device N` - выбрать устройство вывода звука для записи (по умолчанию скрипт сам найдет динамики или наушники)
   - `--duration N` - длительность записи в секундах (по умолчанию 30 сек)
   - `--output FILE` - путь для сохранения аудиофайла

3. Советы:
   - Лучше использовать наушники во время записи
   - Убедитесь, что система выводит звук на выбранное устройство
   - Если качество записи низкое, попробуйте выбрать другое устройство через параметр `--device`

### Техническая информация

Запись звука собеседника работает через прямой захват аудиопотока с выбранного устройства вывода. Это позволяет записывать звук, который воспроизводится на вашем компьютере, включая голос собеседника из программ видеоконференций, звонков или медиаплееров.

Для транскрибации используется библиотека Vosk и встроенная модель распознавания русской речи.

## Структура проекта

- `main.py`